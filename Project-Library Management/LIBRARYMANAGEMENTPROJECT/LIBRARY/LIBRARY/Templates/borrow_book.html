{% extends 'index.html' %}
{% load static %}
{% block title %}Borrow books{% endblock %}
{% block css %}{% endblock %}

{% block content %}
<main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Borrow books</h1>
</div>
<p>Enter the card number to query all borrowed books for the loan certificate, and enter the card number and book number to borrow the book.</p><br>
<div
  </div><form action="/borrow_book/" method="post">{% csrf_token %}
<div class="row">
  <div class="col-sm-12">
        <form class="form-borrow" action="/borrow_book/" method="post">{% csrf_token %}
          <div class="form-row" >
              <div class="form-group col-md-3">
              <input type="text" class="form-control" id="inputCard" placeholder="Card No" name="cno">
                </div>
            <div class="form-group col-md-3">
              <input type="text" class="form-control" id="inputBno" placeholder="ISBN" name="bno">
            </div>
          </div>
  </div>
</div>

  <input class="btn btn-primary" type="submit" value="Inquire" name="btn_borrow_record">
    <input class="btn btn-warning" type="submit" value="Borrow" name="btn_borrow">

    <hr>
{% if messages %}
{% for message in messages %}
{% if message.tags == "success" %}
<div class="alert alert-success col-md-3">
    <a href="#" class="close" data-dismiss="alert">
        &times;
    </a>
    <span>{{ message }}</span>
</div>
{% else %}
<div class="alert alert-danger col-md-3">
    <a href="#" class="close" data-dismiss="alert">
        &times;
    </a>
    <span>{{ message }}</span>
</div>
{% endif %}
{% endfor %}
{% endif %}

</form>

<!--search result -->
{% if card_record %}
   <div class="table-responsive">
<table class="table table-striped table-sm">
  <thead>
    <th>Card number</th>
    <th>ISBN</th>
    <th>Borrow time</th>
    <th>Return time</th>
    <th>Admin id</th>
  </thead>
  <tbody>
  {% for row in card_record %}
  <tr>
    <td> {{ row.cno_id }} </td>
    <td> {{ row.bno_id }} </td>
    <td> {{ row.borrow_date }} </td>
      <td> {{ row.return_date}} </td>
      <td> {{ row.admin_id_id}} </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
</div>
{% endif %}

{% if borrowed_books %}
<br/>
<div class="table-responsive">
<table class="table table-striped table-sm">
  <thead>
    <th>ISBN</th>
    <th>Category</th>
    <th>Title</th>
    <th>Press</th>
    <th>Year</th>
    <th>Author</th>
    <th>Price</th>
    <th>Quantity</th>
  </thead>
  <tbody>
  {% for row in borrowed_books %}
  <tr>
    <td> {{ row.bno }} </td>
    <td> {{ row.category }} </td>
    <td> {{ row.title}} </td>
      <td> {{ row.press}} </td>
      <td> {{ row.year}} </td>
      <td> {{ row.author}} </td>
      <td> {{ row.price}} </td>
      <td> {{ row.stock}} </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
</div>
{% endif %}
</main>
{% endblock%}